{% assign chapter_titles = site.categories | sort %}

<h4>RUCS</h4>
<div class="height-fix">
  <div class="row cyan darken-2">
    <div class="marginless-col col m4 l3 hide-on-small-and-down">
      <div class="marginless-collection collection">

        {% for chapter in chapter_titles %}

        {% if forloop.first == true %}

        <a href="#{{ chapter[0] | replace: ' ', '-' }}" class="waves-effect waves-light collection-item active">
          <span class="toc-enum">Chapter {{ forloop.index }}</span></br>
          <span class="toc-title">{{ chapter[0] | capitalize }}</span>
        </a>

        {% else %}

        <a href="#{{ chapter[0] | replace: ' ', '-' }}" class="waves-effect waves-light collection-item">
          <span class="toc-enum">Chapter {{ forloop.index }}</span></br>
          <span class="toc-title">{{ chapter[0] | capitalize }}</span>
        </a>

        {% endif %}

        {% endfor %}

      </div>
    </div>

    <div class="marginless-col col s12 hide-on-med-and-up show-on-small">
      <ul class="collapsible" data-collapsible="accordion">

        {% for chapter in chapter_titles %}
          {% if forloop.first == true %}
            <li>
              <div class="collapsible-header active">{{ chapter[0] }}</div>
              <div class="collapsible-body"></div>
            </li>

          {% else %}
            <li>
              <div class="collapsible-header">{{ chapter[0] }}</div>
              <div class="collapsible-body"></div>
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    </div>

    <div class="marginless-col col s12 m8 l9 height-fix" style="height:413px; overflow: scroll" id="toc-content-wrapper">
      <div class="toc-content height-fix" id="toc-content">

        {% for chapter in site.categories %}
          <div class="toc-chapter-content" id="{{ chapter[0] | replace: ' ', '-' }}">
            {% for abstracts in chapter %}
              {% if forloop.first == false %}
                {% if abstracts.size == 1 %}
                  {% for abstract in abstracts %}

                      {% include marginless_card_panel.html %}

                  {% endfor %}               
                {% elsif abstracts.size == 2 %}
                  {% for abstract in abstracts %}
                        
                        {% include marginless_card_panel.html %}


                  {% endfor %}
                {% elsif abstracts.size == 3 %}
                  {% for abstract in abstracts %}
                    
                      {% include marginless_card_panel.html %}
                        
                  {% endfor %}
                {% else %}
                  {% assign modulo = {{ abstracts | size | modulo:2 }} %}
                  {% if modulo == 0 %}
                    {% for abstract in abstracts %}
                        
                        {% include marginless_card_panel.html %}

                    {% endfor %}
                  {% else %}
                    {% for abstract in abstracts %}

                        {% include marginless_card_panel.html %}

                    {% endfor %}
                  {% endif %}
                {% endif %}
              {% endif %}
            {% endfor %}
          </div>
        {% endfor %}
        <!--
          {% for chapter in site.categories %}
            <div class="toc-chapter-content" id="{{ chapter[0] | replace: ' ', '-' }}">
              {% for abstracts in chapter %}
                {% if forloop.first == false %}
                  {% for abstract in abstracts %}
                      <div class="col s12 m6">
                        <a href='{{ site.baseurl }}{{ abstract.url }}' class="white-text">
                          <div class="marginless-card-panel cyan darken-2">
                            <span class="white-text">{{ abstract.title }}</span><br/>
                            <span class="white-text">{{ abstract.author }}</span><br/>
                            <p class="white-text">{{ abstract.content | strip_html | truncatewords: 20 }}
                            </p>
                          </div>
                        </a>
                      </div>
                  {% endfor %}
                {% endif %}
              {% endfor %}
            </div>
          {% endfor %}
        -->
      </div>
    </div>
  </div>
</div>